{"results": [{"node": {"raw_sql": "{{ config(materialized='table') }}\nwith source_data as (\n    select * from {{source(\"traffic_source\", \"source\")}}\n),\n\nfinal as (\n    SELECT distinct\n    md5(types) as Id,\n    types FROM source_data\n)\n\nselect * from final", "database": "warehouse", "schema": "warehouse", "fqn": ["dbt_", "traffic_models", "dim_types"], "unique_id": "model.dbt_.dim_types", "package_name": "dbt_", "root_path": "/usr/local/airflow/dbt_", "path": "traffic_models/dim_types.sql", "original_file_path": "models/traffic_models/dim_types.sql", "name": "dim_types", "resource_type": "model", "alias": "dim_types", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["traffic_source", "source"]], "depends_on": {"macros": [], "nodes": ["source.dbt_.traffic_source.source"]}, "description": "", "columns": {"Id": {"name": "Id", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/traffic_models/schema.yml", "build_path": "dbt_/target/compiled/dbt_/traffic_models/dim_types.sql", "compiled": true, "compiled_sql": "\nwith source_data as (\n    select * from warehouse.warehouse.source\n),\n\nfinal as (\n    SELECT distinct\n    md5(types) as Id,\n    types FROM source_data\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\nwith source_data as (\n    select * from warehouse.warehouse.source\n),\n\nfinal as (\n    SELECT distinct\n    md5(types) as Id,\n    types FROM source_data\n)\n\nselect * from final", "wrapped_sql": null}, "error": null, "status": null, "execution_time": 0.5519721508026123, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2022-07-28T22:30:52.538880Z", "completed_at": "2022-07-28T22:30:53.084558Z"}, {"name": "execute", "started_at": "2022-07-28T22:30:53.085834Z", "completed_at": "2022-07-28T22:30:53.085866Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized='table') }}\n\nwith source_data as (\n    select * from {{source(\"traffic_source\", \"source\")}}\n),\n\nselection as (\n    select track_id, md5(types) as type_id, traveled_d, avg_speed from source_data\n),\n\ndim_types as (\n    select * from {{ref(\"dim_types\")}}\n), \n\nfinal as (\n    select sel.track_id, dim_types.types, sel.traveled_d, sel.avg_speed\n    from selection as sel \n    LEFT JOIN dim_types on sel.type_id = dim_types.Id\n)\n\nselect * from final", "database": "warehouse", "schema": "warehouse", "fqn": ["dbt_", "traffic_models", "fct_summary"], "unique_id": "model.dbt_.fct_summary", "package_name": "dbt_", "root_path": "/usr/local/airflow/dbt_", "path": "traffic_models/fct_summary.sql", "original_file_path": "models/traffic_models/fct_summary.sql", "name": "fct_summary", "resource_type": "model", "alias": "fct_summary", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["dim_types"]], "sources": [["traffic_source", "source"]], "depends_on": {"macros": [], "nodes": ["source.dbt_.traffic_source.source", "model.dbt_.dim_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "dbt_/target/compiled/dbt_/traffic_models/fct_summary.sql", "compiled": true, "compiled_sql": "\n\nwith source_data as (\n    select * from warehouse.warehouse.source\n),\n\nselection as (\n    select track_id, md5(types) as type_id, traveled_d, avg_speed from source_data\n),\n\ndim_types as (\n    select * from \"warehouse\".\"warehouse\".\"dim_types\"\n), \n\nfinal as (\n    select sel.track_id, dim_types.types, sel.traveled_d, sel.avg_speed\n    from selection as sel \n    LEFT JOIN dim_types on sel.type_id = dim_types.Id\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nwith source_data as (\n    select * from warehouse.warehouse.source\n),\n\nselection as (\n    select track_id, md5(types) as type_id, traveled_d, avg_speed from source_data\n),\n\ndim_types as (\n    select * from \"warehouse\".\"warehouse\".\"dim_types\"\n), \n\nfinal as (\n    select sel.track_id, dim_types.types, sel.traveled_d, sel.avg_speed\n    from selection as sel \n    LEFT JOIN dim_types on sel.type_id = dim_types.Id\n)\n\nselect * from final", "wrapped_sql": null}, "error": null, "status": null, "execution_time": 0.17656993865966797, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2022-07-28T22:30:53.091098Z", "completed_at": "2022-07-28T22:30:53.263606Z"}, {"name": "execute", "started_at": "2022-07-28T22:30:53.264759Z", "completed_at": "2022-07-28T22:30:53.264784Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized='table') }}\n\nwith source_data as (\n    select * from {{source(\"traffic_source\", \"source\")}}\n),\n\nselection as (\n    select track_id, md5(types) as type_id, trajectory from source_data\n),\n\ndim_types as (\n    select * from {{ref(\"dim_types\")}}\n), \n\nfinal as (\n    select sel.track_id, dim_types.types, sel.trajectory as paths\n    from selection as sel \n    LEFT JOIN dim_types on sel.type_id = dim_types.Id\n)\n\nselect * from final", "database": "warehouse", "schema": "warehouse", "fqn": ["dbt_", "traffic_models", "fct_trajectory"], "unique_id": "model.dbt_.fct_trajectory", "package_name": "dbt_", "root_path": "/usr/local/airflow/dbt_", "path": "traffic_models/fct_trajectory.sql", "original_file_path": "models/traffic_models/fct_trajectory.sql", "name": "fct_trajectory", "resource_type": "model", "alias": "fct_trajectory", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["dim_types"]], "sources": [["traffic_source", "source"]], "depends_on": {"macros": [], "nodes": ["source.dbt_.traffic_source.source", "model.dbt_.dim_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "dbt_/target/compiled/dbt_/traffic_models/fct_trajectory.sql", "compiled": true, "compiled_sql": "\n\nwith source_data as (\n    select * from warehouse.warehouse.source\n),\n\nselection as (\n    select track_id, md5(types) as type_id, trajectory from source_data\n),\n\ndim_types as (\n    select * from \"warehouse\".\"warehouse\".\"dim_types\"\n), \n\nfinal as (\n    select sel.track_id, dim_types.types, sel.trajectory as paths\n    from selection as sel \n    LEFT JOIN dim_types on sel.type_id = dim_types.Id\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nwith source_data as (\n    select * from warehouse.warehouse.source\n),\n\nselection as (\n    select track_id, md5(types) as type_id, trajectory from source_data\n),\n\ndim_types as (\n    select * from \"warehouse\".\"warehouse\".\"dim_types\"\n), \n\nfinal as (\n    select sel.track_id, dim_types.types, sel.trajectory as paths\n    from selection as sel \n    LEFT JOIN dim_types on sel.type_id = dim_types.Id\n)\n\nselect * from final", "wrapped_sql": null}, "error": null, "status": null, "execution_time": 0.23206472396850586, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2022-07-28T22:30:53.277836Z", "completed_at": "2022-07-28T22:30:53.496820Z"}, {"name": "execute", "started_at": "2022-07-28T22:30:53.501766Z", "completed_at": "2022-07-28T22:30:53.501802Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(model=ref('dim_types'), column_name='Id') }}", "database": "warehouse", "schema": "warehouse", "fqn": ["dbt_", "schema_test", "unique_dim_types_Id"], "unique_id": "test.dbt_.unique_dim_types_Id", "package_name": "dbt_", "root_path": "/usr/local/airflow/dbt_", "path": "schema_test/unique_dim_types_Id.sql", "original_file_path": "models/traffic_models/schema.yml", "name": "unique_dim_types_Id", "resource_type": "test", "alias": "unique_dim_types_Id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["dim_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.dbt_.dim_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "dbt_/target/compiled/dbt_/schema_test/unique_dim_types_Id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*)\nfrom (\n\n    select\n        Id\n\n    from \"warehouse\".\"warehouse\".\"dim_types\"\n    where Id is not null\n    group by Id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*)\nfrom (\n\n    select\n        Id\n\n    from \"warehouse\".\"warehouse\".\"dim_types\"\n    where Id is not null\n    group by Id\n    having count(*) > 1\n\n) validation_errors\n\n", "wrapped_sql": "\n\n\n\nselect count(*)\nfrom (\n\n    select\n        Id\n\n    from \"warehouse\".\"warehouse\".\"dim_types\"\n    where Id is not null\n    group by Id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "Id", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "Id"}}}, "error": null, "status": null, "execution_time": 0.11940431594848633, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2022-07-28T22:30:53.512666Z", "completed_at": "2022-07-28T22:30:53.625996Z"}, {"name": "execute", "started_at": "2022-07-28T22:30:53.627575Z", "completed_at": "2022-07-28T22:30:53.627602Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2022-07-28T22:30:53.729370Z", "elapsed_time": 1.2942252159118652}